<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë©”ëª¨ì¥</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:        #0f1117;
      --sidebar:   #13161f;
      --surface:   #1a1d27;
      --surface2:  #222636;
      --border:    rgba(255,255,255,0.07);
      --text:      #e2e8f0;
      --muted:     rgba(226,232,240,0.4);
      --accent:    #6366f1;
      --accent-bg: rgba(99,102,241,0.15);
      --danger:    #f87171;
      --danger-bg: rgba(248,113,113,0.1);
    }

    html, body {
      height: 100%;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    /* â”€â”€ Top Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .topbar {
      height: 52px;
      background: var(--sidebar);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      padding: 0 20px;
      gap: 12px;
      flex-shrink: 0;
    }

    .topbar-logo {
      font-size: 15px;
      font-weight: 700;
      color: var(--text);
      margin-right: 8px;
    }

    .topbar-search {
      flex: 1;
      max-width: 280px;
      height: 32px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 0 12px 0 32px;
      color: var(--text);
      font-size: 13px;
      outline: none;
      transition: border-color 0.2s;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' fill='none' stroke='rgba(226,232,240,0.3)' stroke-width='2' viewBox='0 0 24 24'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: 10px center;
    }
    .topbar-search:focus { border-color: var(--accent); }
    .topbar-search::placeholder { color: var(--muted); }

    .topbar-right {
      margin-left: auto;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .btn-new {
      height: 32px;
      padding: 0 14px;
      border-radius: 8px;
      background: var(--accent);
      color: white;
      font-size: 13px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: opacity 0.2s;
    }
    .btn-new:hover { opacity: 0.85; }

    /* â”€â”€ Main Layout â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .main {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    /* â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .sidebar {
      width: 260px;
      flex-shrink: 0;
      background: var(--sidebar);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .sidebar-header {
      padding: 14px 16px 10px;
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: var(--muted);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .note-count {
      background: var(--surface2);
      border-radius: 99px;
      padding: 1px 8px;
      font-size: 11px;
      font-weight: 600;
      color: var(--muted);
    }

    .note-list {
      flex: 1;
      overflow-y: auto;
      padding: 4px 8px 8px;
    }

    .note-list::-webkit-scrollbar { width: 4px; }
    .note-list::-webkit-scrollbar-track { background: transparent; }
    .note-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }

    .note-item {
      padding: 10px 12px;
      border-radius: 10px;
      cursor: pointer;
      transition: background 0.15s;
      margin-bottom: 2px;
      border: 1px solid transparent;
    }
    .note-item:hover { background: var(--surface); }
    .note-item.active {
      background: var(--accent-bg);
      border-color: rgba(99,102,241,0.25);
    }

    .note-item-title {
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-bottom: 3px;
    }
    .note-item.active .note-item-title { color: #a5b4fc; }

    .note-item-preview {
      font-size: 12px;
      color: var(--muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .note-item-date {
      font-size: 11px;
      color: rgba(226,232,240,0.25);
      margin-top: 4px;
    }

    /* empty state */
    .empty-list {
      padding: 32px 16px;
      text-align: center;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.7;
    }

    /* â”€â”€ Editor â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .editor-wrap {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .editor-toolbar {
      height: 48px;
      padding: 0 24px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 10px;
      flex-shrink: 0;
    }

    .title-input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      font-size: 16px;
      font-weight: 700;
      color: var(--text);
      min-width: 0;
    }
    .title-input::placeholder { color: var(--muted); font-weight: 400; }

    .editor-actions {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
    }

    .save-indicator {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .save-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #34d399;
    }
    .save-dot.unsaved { background: #fbbf24; }

    .btn-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: transparent;
      border: 1px solid var(--border);
      color: var(--muted);
      font-size: 14px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.15s, color 0.15s;
    }
    .btn-icon:hover { background: var(--surface2); color: var(--text); }
    .btn-icon.danger:hover { background: var(--danger-bg); color: var(--danger); border-color: rgba(248,113,113,0.2); }

    .content-area {
      flex: 1;
      padding: 24px 32px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }

    .content-area::-webkit-scrollbar { width: 6px; }
    .content-area::-webkit-scrollbar-track { background: transparent; }
    .content-area::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 3px; }

    .body-input {
      flex: 1;
      width: 100%;
      min-height: 400px;
      background: transparent;
      border: none;
      outline: none;
      font-size: 15px;
      color: var(--text);
      line-height: 1.8;
      resize: none;
      font-family: inherit;
    }
    .body-input::placeholder { color: var(--muted); }

    .editor-footer {
      padding: 10px 32px;
      border-top: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: 16px;
      flex-shrink: 0;
    }

    .char-count {
      font-size: 12px;
      color: rgba(226,232,240,0.25);
    }

    /* empty editor state */
    .empty-editor {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 12px;
      color: var(--muted);
    }

    .empty-editor-icon {
      font-size: 40px;
      opacity: 0.3;
    }

    .empty-editor p {
      font-size: 14px;
      text-align: center;
      line-height: 1.7;
    }

    /* â”€â”€ ë°˜ì‘í˜• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (max-width: 640px) {
      .sidebar { width: 200px; }
      .content-area { padding: 16px 20px; }
      .editor-footer { padding: 10px 20px; }
      .editor-toolbar { padding: 0 16px; }
    }
  </style>
</head>
<body>

  <!-- Top Bar -->
  <div class="topbar">
    <span class="topbar-logo">ğŸ““ ë©”ëª¨ì¥</span>
    <input class="topbar-search" type="text" id="searchInput" placeholder="ë©”ëª¨ ê²€ìƒ‰..." />
    <div class="topbar-right">
      <button class="btn-new" id="newNoteBtn">+ ìƒˆ ë©”ëª¨</button>
    </div>
  </div>

  <!-- Main -->
  <div class="main">

    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <span>ë©”ëª¨</span>
        <span class="note-count" id="noteCount">0</span>
      </div>
      <div class="note-list" id="noteList"></div>
    </div>

    <!-- Editor -->
    <div class="editor-wrap" id="editorWrap">
      <!-- ì„ íƒ ì „ empty state -->
      <div class="empty-editor" id="emptyEditor">
        <div class="empty-editor-icon">ğŸ“</div>
        <p>ë©”ëª¨ë¥¼ ì„ íƒí•˜ê±°ë‚˜<br>ìƒˆ ë©”ëª¨ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”</p>
      </div>
    </div>

  </div>

  <script>
  (function () {
    const STORAGE_KEY = 'notepad_notes';

    /* â”€â”€ ìƒíƒœ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    let notes = load();
    let activeId = null;
    let saveTimer = null;

    /* â”€â”€ ì´ˆê¸°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    renderList();
    if (notes.length > 0) selectNote(notes[0].id);

    /* â”€â”€ ì´ë²¤íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    document.getElementById('newNoteBtn').addEventListener('click', createNote);
    document.getElementById('searchInput').addEventListener('input', function () {
      renderList(this.value.trim());
    });

    /* â”€â”€ CRUD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function createNote() {
      const note = {
        id:      Date.now(),
        title:   '',
        body:    '',
        updatedAt: Date.now(),
      };
      notes.unshift(note);
      save();
      renderList();
      selectNote(note.id);
      // ì œëª© ì¸í’‹ì— í¬ì»¤ìŠ¤
      const t = document.getElementById('titleInput');
      if (t) { t.focus(); }
    }

    function deleteNote(id) {
      if (!confirm('ì´ ë©”ëª¨ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
      notes = notes.filter(n => n.id !== id);
      save();
      activeId = null;
      renderList();
      if (notes.length > 0) {
        selectNote(notes[0].id);
      } else {
        showEmptyEditor();
      }
    }

    function updateNote(field, value) {
      const note = notes.find(n => n.id === activeId);
      if (!note) return;
      note[field]    = value;
      note.updatedAt = Date.now();
      // ì €ì¥ í‘œì‹œ â†’ unsaved
      setSaveState('unsaved');
      // ë””ë°”ìš´ìŠ¤ ì €ì¥
      clearTimeout(saveTimer);
      saveTimer = setTimeout(function () {
        save();
        renderList();
        setSaveState('saved');
      }, 600);
    }

    /* â”€â”€ ë Œë”ë§ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function renderList(query) {
      const list = document.getElementById('noteList');
      const countEl = document.getElementById('noteCount');

      let filtered = notes;
      if (query) {
        const q = query.toLowerCase();
        filtered = notes.filter(n =>
          n.title.toLowerCase().includes(q) ||
          n.body.toLowerCase().includes(q)
        );
      }

      countEl.textContent = filtered.length;

      if (filtered.length === 0) {
        list.innerHTML = '<div class="empty-list">' +
          (query ? 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.' : 'ë©”ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤.<br>ìƒˆ ë©”ëª¨ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”.') +
          '</div>';
        return;
      }

      list.innerHTML = filtered.map(function (n) {
        const isActive = n.id === activeId;
        const title    = n.title || 'ì œëª© ì—†ìŒ';
        const preview  = n.body.replace(/\n/g, ' ') || 'ë‚´ìš© ì—†ìŒ';
        const date     = formatDate(n.updatedAt);
        return '<div class="note-item' + (isActive ? ' active' : '') + '" data-id="' + n.id + '">' +
          '<div class="note-item-title">' + escHtml(title) + '</div>' +
          '<div class="note-item-preview">' + escHtml(preview) + '</div>' +
          '<div class="note-item-date">' + date + '</div>' +
          '</div>';
      }).join('');

      // í´ë¦­ ì´ë²¤íŠ¸
      list.querySelectorAll('.note-item').forEach(function (el) {
        el.addEventListener('click', function () {
          selectNote(Number(this.dataset.id));
        });
      });
    }

    function selectNote(id) {
      activeId = id;
      const note = notes.find(n => n.id === id);
      if (!note) return;

      const wrap = document.getElementById('editorWrap');
      wrap.innerHTML =
        '<div class="editor-toolbar">' +
          '<input class="title-input" id="titleInput" type="text" placeholder="ì œëª©" value="' + escAttr(note.title) + '" />' +
          '<div class="editor-actions">' +
            '<div class="save-indicator"><div class="save-dot" id="saveDot"></div><span id="saveLabel">ì €ì¥ë¨</span></div>' +
            '<button class="btn-icon danger" id="deleteBtn" title="ì‚­ì œ">ğŸ—‘</button>' +
          '</div>' +
        '</div>' +
        '<div class="content-area">' +
          '<textarea class="body-input" id="bodyInput" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...">' + escHtml(note.body) + '</textarea>' +
        '</div>' +
        '<div class="editor-footer">' +
          '<span class="char-count" id="charCount">0ì</span>' +
        '</div>';

      // ì´ë²¤íŠ¸ ì—°ê²°
      document.getElementById('titleInput').addEventListener('input', function () {
        updateNote('title', this.value);
        renderList(document.getElementById('searchInput').value.trim());
      });

      const bodyInput = document.getElementById('bodyInput');
      bodyInput.addEventListener('input', function () {
        updateNote('body', this.value);
        updateCharCount(this.value);
      });
      updateCharCount(note.body);

      document.getElementById('deleteBtn').addEventListener('click', function () {
        deleteNote(activeId);
      });

      // ì‚¬ì´ë“œë°” active ê°±ì‹ 
      document.querySelectorAll('.note-item').forEach(function (el) {
        el.classList.toggle('active', Number(el.dataset.id) === activeId);
      });
    }

    function showEmptyEditor() {
      const wrap = document.getElementById('editorWrap');
      wrap.innerHTML =
        '<div class="empty-editor" id="emptyEditor">' +
          '<div class="empty-editor-icon">ğŸ“</div>' +
          '<p>ë©”ëª¨ë¥¼ ì„ íƒí•˜ê±°ë‚˜<br>ìƒˆ ë©”ëª¨ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”</p>' +
        '</div>';
    }

    /* â”€â”€ ìœ í‹¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    function setSaveState(state) {
      const dot   = document.getElementById('saveDot');
      const label = document.getElementById('saveLabel');
      if (!dot || !label) return;
      if (state === 'unsaved') {
        dot.classList.add('unsaved');
        label.textContent = 'ì €ì¥ ì¤‘...';
      } else {
        dot.classList.remove('unsaved');
        label.textContent = 'ì €ì¥ë¨';
      }
    }

    function updateCharCount(text) {
      const el = document.getElementById('charCount');
      if (el) el.textContent = text.length.toLocaleString() + 'ì';
    }

    function formatDate(ts) {
      const d    = new Date(ts);
      const now  = new Date();
      const diff = now - d;
      const m    = Math.floor(diff / 60000);
      const h    = Math.floor(diff / 3600000);
      const day  = Math.floor(diff / 86400000);
      if (m < 1)  return 'ë°©ê¸ˆ ì „';
      if (m < 60) return m + 'ë¶„ ì „';
      if (h < 24) return h + 'ì‹œê°„ ì „';
      if (day < 7) return day + 'ì¼ ì „';
      return d.getFullYear() + '.' +
        String(d.getMonth() + 1).padStart(2, '0') + '.' +
        String(d.getDate()).padStart(2, '0');
    }

    function escHtml(str) {
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;');
    }

    function escAttr(str) {
      return String(str).replace(/"/g, '&quot;').replace(/'/g, '&#39;');
    }

    function load() {
      try {
        return JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
      } catch (e) {
        return [];
      }
    }

    function save() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(notes));
    }

  })();
  </script>

</body>
</html>
